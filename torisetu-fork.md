# 元の取扱説明書
[こちら](./torisetu.md)

---

## ✨ 機能的な変更点

#### コミュニケーション & リアクション
- **セリフの動的変更**: `serifs.yml` を編集することで、藍のセリフを自由に変更できます。
- **反応する名前の変更**: `config.json` の `aiName` を変更することで、藍が反応する名前を変えられます。
- **キーワードによる絵文字リアクション追加**: 特定のキーワードに反応する絵文字の種類を増やしました。
- **"Follow Me" の制限機能**: `include` (対象に含める) / `exclude` (対象から除外) を設定できます。(ローカルユーザーは常に許可されます)

#### 情報取得機能 (メンションで応答)
- **天気予報**: `@(bot名) てんき [地名]` のようにメンションすると、その場所の天気予報を返します。(データソース: [tsukumijima.net](https://weather.tsukumijima.net/))
- **気圧情報**: `@(bot名) 気圧` のようにメンションすると、`config.json` で設定された場所の気圧情報を返します。(データソース: zutool)
- **地震速報**: [wolfx](https://github.com/wolf-dog) と連携し、地震速報をノートに投稿する機能を追加しました。

#### その他の変更
- **キーワード学習の仕様変更**:
  - 学習対象を `public/home` タイムラインに変更しました。
  - 学習頻度を30分に一度に変更しました。
- **一部機能の無効化**: `maze` や `poll` 機能を `config.json` から無効化できます。
- **WebSocket接続の安定化**: 定期的にハートビートを送信し、接続を維持するように改善しました。
- **フォロー解除監視**: 藍をフォローしていないユーザーをフォロー解除する機能を追加しました。

---

## 🤖 AIチャット (aichat) の変更点
- **対話の対象ソース変更**: `public/home` タイムラインの投稿からも対話のきっかけを拾うように変更しました。(藍がフォローしているユーザーの投稿のみが対象です)
- **意図しない対話の防止**: 藍がフォローしていないユーザーからのメンションには反応しないように変更しました。
- **独り言機能**: `config.json` で設定した確率・頻度・プロンプトに基づいて、藍が自発的に独り言を投稿する機能を追加しました。
- **Misskeyチャットへの対応**: Misskeyのチャット機能での会話に対応しました。(チャット専用の終了コマンドも追加)
- **YouTubeコンテンツの理解**: 共有されたYouTubeリンクの情報を読み込み、対話に利用できるようになりました。
- **Geminiモデルの選択**: `config.json` で使用するGeminiのモデルを自由に変更できます。
- **エラー表示の改善**: APIでエラーが発生した際に、原因が分かりやすいように表示を改善しました。
- その他、内部的なプロンプトの改善を継続的に行っています。

---

## 🔧 技術的な変更点 (開発者向け)
- **pnpm への移行**: パッケージ管理をnpm/yarnからpnpmへ移行し、インストール速度とディスク効率を改善しました。
- **Biome の導入**: 高速なリンター/フォーマッターであるBiomeを導入し、コード品質と開発効率を高めました。
- **Renovate の導入**: 依存関係の更新を自動化するRenovateを導入し、プロジェクトを常に最新の状態に保ちます。
- **`napi-rs/canvas` への移行**: 画像処理ライブラリを `canvas` から `napi-rs/canvas` へ移行し、パフォーマンスと互換性を向上させました。
- **コンテナのタイムゾーン修正**: コンテナのタイムゾーンを `Asia/Tokyo` に設定し、時刻関連の処理が正しく行われるようにしました。
